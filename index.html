<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>pageYOffset Test</title>
</head>
<body>

  <div style="height:99in; background:#eee; padding: 5em; font: 1em/1.5 arial">
    This is a very tall div, so that you can scroll.<br><br>
    <div id="nonZeroScroll" style="display:none; position: fixed; top: 8em; left: 5em;">
      You've scrolled!<br>
      Now hit refresh to see if your browser remembers
      immediately---or eventually---that you scrolled.
    </div>
    <div id="timeToRemember"></div>
  </div>
  
  <script>
    // start your engines...
    var start = Date.now();
    var nonZeroScroll = document.getElementById('nonZeroScroll');
    var timeToRemember = document.getElementById('timeToRemember');
    if(window.pageYOffset > 0){
      //timeToRemember.style.display = '';
      timeToRemember.innerHTML = 'Yay! Your browser knew from the start that it was restoring a scroll position!';
    } else {
      requestAnimationFrame(function tick() {
        if (window.pageYOffset > 0) {
          //timeToRemember.style.display = '';
          timeToRemember.innerHTML = 'Boo! Your browser didn\'t realize that it was restoring a scroll position until after ' + (Date.now() - start) + ' milliseconds!';
        } else {
          requestAnimationFrame(tick);
        }
      });
    }
    if(sessionStorage.step !== '1'){
      window.addEventListener('scroll', function onScroll(){
        sessionStorage.step = '1';
        nonZeroScroll.style.display = '';
        window.removeEventListener('scroll', onScroll);
      });
    }
  </script>
  
</body>
</html>
